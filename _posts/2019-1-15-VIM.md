---
layout:     post
title:      "Vim优秀插件推荐"
subtitle:   "C++开发常用Vim插件梳理"
date:       2019-1-15 10:00:00
author:     "baiyf"
header-img: "img/home-bg-o.jpg"
header-mask: 0.3
catalog:    true
tags:
    - 工具

---

# Vim优秀插件推荐

> 本文内容转载自博客：https://blog.csdn.net/guicaisa/article/details/52389907

## Vim的安装

- Mac平台：

  安装包管理工具homebrew

  ```bash
   ruby -e "$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)"
  ```

  通过brew安装vim

  ```bash
  brew install vim
  ```

- Centos平台：

  ```bash
  yum install vim
  ```

## 插件管理工具

本文以pathogen为例进行插件目录管理

安装

```bash
mkdir -p ~/.vim/autoload ~/.vim/bundle && 
curl -LSso ~/.vim/autoload/pathogen.vim https://tpo.pe/pathogen.vim
```

对插件进行配置，打开~/.vimrc，进行编辑

```bash
execute pathogen#infect()
syntax on
filetype plugin indent on
```

保存退出后该工具就生效了，此时./vim目录结构是这样的：

```bash
├── autoload
│   └── pathogen.vim
└── bundle
```

## auto-pairs

功能

自动匹配括号、引号等符号

安装

```bash
git clone git://github.com/jiangmiao/auto-pairs.git ~/.vim/bundle/auto-pairs
```

## NERDTree

功能

显示当前文件夹目录树

安装

```bash
git clone https://github.com/scrooloose/nerdtree.git ~/.vim/bundle/NERDTree
```

该插件的基本操作有

```bash
文件相关操作
o  : 在光标所在的上一个窗口打开文件，并将光标置于新打开的窗口
go : 预览文件，光标停留在NERDTree窗口中
t  : 在新标签中打开文件并激活
gt : 在新标签打开文件，光标留在NERDTree窗口中
i  : 水平分割打开文件
gi : 水平分割预览
s  : 垂直分割打开文件
gs : 垂直分割预览
 
目录树相关操作
o  : 展开/关闭目录
O  : 递归展开目录。慎用，如果目录层级多，打开会很慢
x  : 关闭父目录
C  : 切换光标所在目录为根目录
u  : 切换目录树的根目录为上层目录
U  : 切换目录树的根目录为上层目录，并保持旧的目录树的状态
r  : 刷新当前目录
R  : 刷新当前根目录（这个在新加入文件后会用到）
cd : 切换vim工作目录为光标所在目录（命令模式下:pwd可查看当前工作目录）
```

为了方便打开NERDTree，我们可以设置快捷键，打开~/.vimrc，插入如下一行

```bash
map <C-n> :NERDTree<CR>
```

这样，当打开vim时，只要输入ctrl+n即可打开NERDTree

## MiniBufExplorer

功能

显示已经打开的buffer，类似于将多文件以标签页的形式并列

安装

```bash
mkdir -p ~/.vim/bundle/minibufexplorer/plugin && wget "http://www.vim.org/scripts/download_script.php?src_id=3640" -O ~/.vim/bundle/minibufexplorer/plugin/minibufexpl.vim
```

在命令模式下，我们输入`:ls`可以查看打开的buffer列表，每一行前面的数字对应buffer的编号，通过输入`:b N`，其中N代表buffer编号，可以打开对应的buffer

配置

在~/.vimrc文件中加入如下命令

```bash
let g:miniBufExplMaxSize = 2
```

该配置含义为minibufexplorer窗口最大高度为2行，默认是没有上限的，你打开的buffer足够多，一会一直增长下去，为了方便阅读我一般将它设为2，其它配置不怎么用到，需要用的时候可以参考插件文件，并在~/.vimrc中添加配置

## ctags

- Mac安装：

  ```bash
  brew install ctags
  ```

- Centos安装：

  ```bash
  yum install ctags
  ```

创建索引：在你代码的根目录执行如下命令，会生成一个tags文件，此时在代码根目录下打开一个文件（vim默认只加载工作目录下的tags文件），将光标置于一个函数或结构体名字上，按`ctr+]`即可跳转到该名称的定义处，如果出现多个选项，可以输入编号选择对应跳转的地方，按`ctr+o`可回到光标之前的位置

```bash
ctags -R --sort=yes --c++-kinds=+p --fields=+iaS --extra=+q --language-force=C++
```

## taglist

功能

将代码内的函数、变量等按规矩列出来，方便查找

安装

```bash
cd ~/.vim/bundle && wget "http://www.vim.org/scripts/download_script.php?src_id=19574" -O taglist.zip && unzip taglist.zip -d taglist
```

这样就生成了~/.vim/bundle/taglist目录，该目录的结构为

```bash
taglist
├── doc
│   └── taglist.txt
└── plugin
    └── taglist.vim
```

配置
打开~/.vimrc，输入如下内容

```bash
let Tlist_Show_One_File=1    “ 只展示一个文件的taglist
let Tlist_Exit_OnlyWindow=1  “ 当taglist是最后以个窗口时自动退出
let Tlist_Use_Right_Window=1 " 在右边显示taglist窗口
let Tlist_Sort_Type="name"   “ tag按名字排序
```

这几行配置看名字就能知道什么意思，引号后边是说明，在vim配置文件里，双引号代表注释，类似于C语言里的/

测试
打开一个文件，在命令行模式下输入`:TlistToggle`即可显示taglist窗口

## OmniCppComplete

这是一个对C++进行语法补全的插件，可以对函数、命名空间、类成员等进行补全，使用起来和绝大多数IDE差不多，不一样的是IDE为你做了很多你不知道的事情，而omni补全需要依赖tags文件，需要你用ctags命令自己生成

安装

```bash
cd ~/.vim/bundle && wget "http://www.vim.org/scripts/download_script.php?src_id=7722" -O omnicppcomplete.zip && unzip omnicppcomplete.zip -d omnicppcomplete
```

该命令会生成~/.vim/bundle/omnicppcomplete目录，目录结构为

```bash
├── after
│   └── ftplugin
│       ├── cpp.vim
│       └── c.vim
├── autoload
│   └── omni
│       ├── common
│       │   ├── debug.vim
│       │   └── utils.vim
│       └── cpp
│           ├── complete.vim
│           ├── includes.vim
│           ├── items.vim
│           ├── maycomplete.vim
│           ├── namespaces.vim
│           ├── settings.vim
│           ├── tokenizer.vim
│           └── utils.vim
└── doc
    └── omnicppcomplete.txt
```

打开vim，在命令行模式下输入`:helptags ~/.vim/bundle/omnicppcomplete/doc`即可加载说明文档，输入`:help omnicppcomplete`查看说明文档

配置
打开~/.vimrc文件，输入

```bash
filetype plugin indent on
set completeopt=longest,menu
let OmniCpp_NamespaceSearch = 2     " search namespaces in the current buffer   and in included files
let OmniCpp_ShowPrototypeInAbbr = 1 " 显示函数参数列表
let OmniCpp_MayCompleteScope = 1    " 输入 :: 后自动补全
let OmniCpp_DefaultNamespaces = ["std", "_GLIBCXX_STD"]
```

对STL补全
上面的方式只能对自己的代码进行补全，是当我们要使用其它库比如STL甚至是第三方库时就无法补全，原因很简单，我们只对自己的代码建立了tags文件，想要对其它库进行补全，就必须对它们的源代码建立tags文件，所幸的是vim的插件编写者们早已解决了这个需求，并且他们专门针对STL头文件进行了修改，以便能更好的适应omni的补全，首先下载STL源代码，地址为<http://www.vim.org/scripts/script.php?script_id=2358>，可通过如下命令下载并解压

```bash
mkdir -p ~/.vim/tags && cd ~/.vim/tags && wget "http://www.vim.org/scripts/download_script.php?src_id=9178" -O - | tar jxvf -
```

这样就将STL的源码下载到了~/.vim/tags/cpp_src目录下，我们在该目录下执行ctags命令

```bash
ctags -R --sort=yes --c++-kinds=+p --fields=+iaS --extra=+q --language-force=C++
```

这样就生成了~/.vim/tags/cpp_src/tags这个文件，然后打开~/.vimrc进行如下设置

```bash
set tags+=~/.vim/tags/cpp_src/tags
```

该命令是设置tags文件的搜索路径，默认只有vim工作目录的tags文件，这样设置之后就会同时加载指定目录的tags文件，你可以在后面添加更多其它第三方库的tags文件，现在对STL的补全效果如下

在生成tags文件的基础山，按`ctr+x ctr+o`就可以自动补全

## SuperTab

功能

使用tab键自动补全输入

安装

```bash
cd ~/.vim/bundle && git clone https://github.com/ervandew/supertab.git
```

测试

无需任何配置即可使用，这时你想要补全变量名或函数名只需按一下TAB键即可，出现候选窗口之后也可以用TAB键进行选择，这样是不是方便了很多！

由于TAB键被映射成了补全快捷键，也就无法通过TAB键直接输入制表符，这时如果想要输入制表符可以通过`ctr+v TAB`即可，即先输入ctr+v再输入TAB键，在vim下通过ctl+v可以输入很多不可见字符，比如试试`ctr+v ctr+w`

## 最终的配置文件

装了这么多插件，在配置文件~/.vimrc里也增添了不少内容，最后你的配置文件至少应该包含以下内容

```bash
set tags+=~/.vim/tags/cpp_src/tags   " 设置tags搜索路径
syntax on
filetype plugin indent on
" pathongen
execute pathogen#infect()

map <C-n> :NERDTree<CR>

" taglist
let Tlist_Show_One_File=1
let Tlist_Exit_OnlyWindow=1
let Tlist_Use_Right_Window=1
let Tlist_Sort_Type="name"
" omnicppcomplete
set completeopt=longest,menu
let OmniCpp_NamespaceSearch = 2     " search namespaces in the current buffer and in included files
let OmniCpp_ShowPrototypeInAbbr = 1 " 显示函数参数列表
let OmniCpp_MayCompleteScope = 1    " 输入 :: 后自动补全
let OmniCpp_DefaultNamespaces = ["std", "_GLIBCXX_STD"]
```

> 还有Syntastic，NERD Commenter，Snipmate，undotree，gdbmgr等工具以后使用过了再补充到这里